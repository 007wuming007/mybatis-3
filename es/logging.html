<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<!-- Generated by Apache Maven Doxia Site Renderer 1.6 at 2016-03-04 -->
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="es" lang="es">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
    <title>MyBatis &#x2013; MyBatis 3 | Logging</title>
    <style type="text/css" media="all">
      @import url("./css/maven-base.css");
      @import url("./css/maven-theme.css");
      @import url("./css/site.css");
    </style>
    <link rel="stylesheet" href="./css/print.css" type="text/css" media="print" />
      <meta name="author" content="Clinton Begin" />
      <meta name="author" content="Eduardo Macarron" />
    <meta name="Date-Revision-yyyymmdd" content="20160304" />
    <meta http-equiv="Content-Language" content="es" />
        
        </head>
  <body class="composite">
    <div id="banner">
                    <div id="bannerLeft">
                mybatis
                </div>
                    <div class="clear">
        <hr/>
      </div>
    </div>
    <div id="breadcrumbs">
            
                    
                <div class="xleft">
        <span id="publishDate">Publicado el: 2016-03-04</span>
                  &nbsp;| <span id="projectVersion">Versión: 3.4.0-SNAPSHOT</span>
                      </div>
            <div class="xright">        
                    
      </div>
      <div class="clear">
        <hr/>
      </div>
    </div>
    <div id="leftColumn">
      <div id="navcolumn">
             
                    
                                <h5>Manual de Referencia</h5>
                  <ul>
                  <li class="none">
                          <a href="index.html" title="Introducción">Introducción</a>
            </li>
                  <li class="none">
                          <a href="getting-started.html" title="Primeros pasos">Primeros pasos</a>
            </li>
                                                                                                                                                                                                                    <li class="collapsed">
                          <a href="configuration.html" title="Configuración">Configuración</a>
                  </li>
                                                                                                                                                              <li class="collapsed">
                          <a href="sqlmap-xml.html" title="Ficheros XML de mapeo">Ficheros XML de mapeo</a>
                  </li>
                  <li class="none">
                          <a href="dynamic-sql.html" title="SQL dinámico">SQL dinámico</a>
            </li>
                                                                                      <li class="collapsed">
                          <a href="java-api.html" title="Java API">Java API</a>
                  </li>
                  <li class="none">
                          <a href="statement-builders.html" title="La clase SQL">La clase SQL</a>
            </li>
                  <li class="none">
            <strong>Logging</strong>
          </li>
          </ul>
                       <h5>Documentación del proyecto</h5>
                  <ul>
                                                                                                                                                                                                                                                                          <li class="collapsed">
                          <a href="project-info.html" title="Información del proyecto">Información del proyecto</a>
                  </li>
                                                                                                                                                                                                                                                                                            <li class="collapsed">
                          <a href="project-reports.html" title="Informes del proyecto">Informes del proyecto</a>
                  </li>
          </ul>
                             <a href="http://maven.apache.org/" title="Generado por Maven" class="poweredBy">
        <img class="poweredBy" alt="Generado por Maven" src="./images/logos/maven-feather.png" />
      </a>
                   
                    
            </div>
    </div>
    <div id="bodyColumn">
      <div id="contentBox">
        <!-- Copyright 2010-2012 the original author or authors.

  Licensed under the Apache License, Version 2.0 (the "License");
  you may not use this file except in compliance with the License.
  You may obtain a copy of the License at

    http://www.apache.org/licenses/LICENSE-2.0

  Unless required by applicable law or agreed to in writing, software
  distributed under the License is distributed on an "AS IS" BASIS,
  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  See the License for the specific language governing permissions and
  limitations under the License. --><!-- version: $Id$ -->

  
    <div class="section">
<h2><a name="Logging"></a>Logging</h2>
      
<p></p>
      
<p>MyBatis proporciona informaci&#xf3;n de logging mediante el uso interno de una factor&#xed;a. La factor&#xed;a interna delega la informaci&#xf3;n de logging en alguna de las siguientes implementaciones.
      </p>
      
<ul>
        
<li>
          SLF4J
        </li>
        
<li>
          Apache Commons Logging
        </li>
        
<li>
          Log4j 2
        </li>
        
<li>
          Log4j
        </li>
        
<li>
          JDK logging
        </li>
      </ul>
      
<p>La soluci&#xf3;n de logging elegida se basa en una introspecci&#xf3;n en tiempo de ejecuci&#xf3;n de la propia factor&#xed;a interna de MyBatis. La factor&#xed;a usar&#xe1; la primera implementaci&#xf3;n de logging que encuentre (el orden de b&#xfa;squeda es el de la lista de m&#xe1;s arriba). Si no se encuentra ninguna, el logging se desactivar&#xe1;.
      </p>
      
<p>Muchos entornos vienen con Commons Logging incluido como pare del classpath del servidor (por ejemplo Tomcat y WebSphere). Es importante conocer que en esos entorno, MyBatis usar&#xe1; JCL como implementaci&#xf3;n de logging. En un entorno como WebSphere esto significa que tu configuraci&#xf3;n de log4j ser&#xe1; ignorada dado que WebSphere proporciona su propia implementaci&#xf3;n de JCL. Esto puede ser muy frustrante porque parece que MyBatis est&#xe1; ignorando tu configuraci&#xf3;n de logging (en realidad, MyBatis est&#xe1; ignorando tu configuraci&#xf3;n de log4j porque est&#xe1; usando JCL en dicho entorno). Si tu aplicaci&#xf3;n se ejecuta en un entorno que lleva JCL incluido pero quieres usar un m&#xe9;todo distinto de logging puedes a&#xf1;adir un setting a tu fichero mybatis-config.xml:
      </p>
      
<div class="source">
<pre>&lt;configuration&gt;
  &lt;settings&gt;
    ...
    &lt;setting name=&quot;logImpl&quot; value=&quot;LOG4J&quot;/&gt;
    ...
  &lt;/settings&gt;
&lt;/configuration&gt;
      </pre></div>
      
<p>Los valores v&#xe1;lidos son: SLF4J, LOG4J, LOG4J2, JDK_LOGGING, COMMONS_LOGGING, STDOUT_LOGGING, NO_LOGGING o
      un nombre de clase plenamente cualificado que implemente <tt>org.apache.ibatis.logging.Log</tt> y reciba
      un string como parametro de constructor.
      </p>
      
<p>Tambien puedes seleccionar el m&#xe9;todo de logging llamando a uno de los siguientes m&#xe9;todos:
      </p>      
      
<div class="source">
<pre>org.apache.ibatis.logging.LogFactory.useSlf4jLogging();
org.apache.ibatis.logging.LogFactory.useLog4JLogging();
org.apache.ibatis.logging.LogFactory.useLog4J2Logging();
org.apache.ibatis.logging.LogFactory.useJdkLogging();
org.apache.ibatis.logging.LogFactory.useCommonsLogging();
org.apache.ibatis.logging.LogFactory.useStdOutLogging();</pre></div>
      
<p>Si eliges llamar a alguno de estos m&#xe9;todos, deber&#xed;as hacerlo antes de llamar a ning&#xfa;n otro m&#xe9;todo de MyBatis. Adem&#xe1;s, estos m&#xe9;todos solo establecer&#xe1;n la implementaci&#xf3;n de log indicada si dicha implementaci&#xf3;n est&#xe1; disponible en el classpath. Por ejemplo, si intentas seleccionar log4j y log4j no est&#xe1; disponible en el classpath, MyBatis ignorar&#xe1; la petici&#xf3;n y usar&#xe1; su algoritmo normal de descubrimiento de implementaciones de logging.
      </p>
      
<p>Los temas espec&#xed;ficos de JCL, Log4j y el Java Logging API quedan fuera del alcance de este documento. Sin embargo la configuraci&#xf3;n de ejemplo que se proporciona m&#xe1;s abajo te ayudar&#xe1; a comenzar. Si quieres conocer m&#xe1;s sobre estos frameworks, puedes obtener m&#xe1;s informaci&#xf3;n en las siguientes ubicaciones:
      </p>
      
<ul>
        
<li>
          <a class="externalLink" href="http://www.slf4j.org/">SLF4J</a>
        </li>
        
<li>
          <a class="externalLink" href="http://commons.apache.org/logging">Apache Commons Logging</a>
        </li>
        
<li>
          <a class="externalLink" href="http://logging.apache.org/log4j/">Apache Log4j 1.x y 2.x</a>
        </li>
        
<li>
          <a class="externalLink" href="http://java.sun.com/j2se/1.4.1/docs/guide/util/logging/">JDK Logging API</a>
        </li>
      </ul>
      
<div class="section">
<h3><a name="Configuracin"></a>Configuraci&#xf3;n</h3>
        
<p>Para ver el log de las sentencias debes activar el log en un paquete, el nombre plenamente cualificado de una clase, un namespace o un nombre plenamente cualificado de un mapped statement.</p>
        
<p>Nuevamente, c&#xf3;mo hagas esto es dependiente de la implementaci&#xf3;n de logging que se est&#xe9; usando. Mostraremos c&#xf3;mo hacerlo con Log4j. Configurar los servicios de logging es simplemente cuesti&#xf3;n de a&#xf1;adir uno o varios ficheros de configuraci&#xf3;n (por ejemplo log4j.properties) y a veces un nuevo JAR (por ejemplo log4j.jar). El ejemplo siguiente configura todos los servicios de logging para que usen log4j como proveedor. S&#xf3;lo son dos pasos:
        </p>
        
<div class="section">
<h4><a name="Paso_1:_Aade_el_fichero_Log4j_JAR"></a>Paso 1: A&#xf1;ade el fichero Log4j JAR
        </h4>
        
<p>Dado que usamos Log4j, necesitaremos asegurarnos que el fichero JAR est&#xe1; disponible para nuestra aplicaci&#xf3;n. Para usar Log4j, necesitas a&#xf1;adir el fichero JAR al classpath de tu aplicaci&#xf3;n. Puedes descargar Log4j desde la URL indicada m&#xe1;s arriba.
        </p>
        
<p>En aplicaciones Web o de empresa debes a&#xf1;adir tu fichero log4j.java a tu directorio WEB-INF/lib, y en una aplicaci&#xf3;n standalone simplemente a&#xf1;&#xe1;dela al par&#xe1;metro &#x2013;classpath de la JVM.
        </p>
        </div>
<div class="section">
<h4><a name="Paso_2:_Configurar_Log4j"></a>
          Paso 2: Configurar Log4j
        </h4>
        
<p>Configurar Log4j es sencillo. Supongamos que quieres habilitar el log para este mapper:</p>
        
<div class="source">
<pre>package org.mybatis.example;
public interface BlogMapper {
  @Select(&quot;SELECT * FROM blog WHERE id = #{id}&quot;)
  Blog selectBlog(int id);
}</pre></div>
        
<p>Crea un fichero con nombre <tt>log4j.properties</tt> 
        como el que se muestra a continuaci&#xf3;n y colocalo en tu classpath:
        </p>
        
<div class="source">
<pre># Global logging configuration
log4j.rootLogger=ERROR, stdout
# MyBatis logging configuration...
log4j.logger.org.mybatis.example.BlogMapper=TRACE
# Console output...
log4j.appender.stdout=org.apache.log4j.ConsoleAppender
log4j.appender.stdout.layout=org.apache.log4j.PatternLayout
log4j.appender.stdout.layout.ConversionPattern=%5p [%t] - %m%n</pre></div>
        
<p>El fichero anterior har&#xe1; que log4j reporte informaci&#xf3;n detallada para <tt>org.mybatis.example.BlogMapper</tt> e informaci&#xf3;n de errores para el resto de las clases de tu aplicaci&#xf3;n.</p>
        
<p>Si quieres activar un nivel m&#xe1;s fino de logging puedes activar el logging para statements espec&#xed;ficos en lugar de para todo un mapper. La siguiente l&#xed;nea activa el logging s&#xf3;lo para el statement <tt>selectBlog</tt>:</p>

        
<div class="source">
<pre>log4j.logger.org.mybatis.example.BlogMapper.selectBlog=TRACE</pre></div>
        
        
<p>Si por el contrario quieres activar el log para un grupo de mappers debes a&#xf1;adir un logger para el paquete raiz donde residen tus mappers:</p>

        
<div class="source">
<pre>log4j.logger.org.mybatis.example=TRACE</pre></div>
        
        
<p>Hay consultas que pueden devolver una gran cantidad de datos. En esos casos puedes querer ver las sentencias SQL pero no los datos. Para conseguirlo las sentencias se loguean con nivel DEBUG (FINE en JDK) y los resultados con TRACE (FINER en JDK), por tanto si quieres ver la sentencia pero no el resultado establece el nivel a DEBUG</p>

        
<div class="source">
<pre>log4j.logger.org.mybatis.example=DEBUG</pre></div>
        
        
<p>Y si est&#xe1;s usando ficheros XML como este?</p>

      
<div class="source">
<pre>&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot; ?&gt;
&lt;!DOCTYPE mapper
  PUBLIC &quot;-//mybatis.org//DTD Mapper 3.0//EN&quot;
  &quot;http://mybatis.org/dtd/mybatis-3-mapper.dtd&quot;&gt;
&lt;mapper namespace=&quot;org.mybatis.example.BlogMapper&quot;&gt;
  &lt;select id=&quot;selectBlog&quot; resultType=&quot;Blog&quot;&gt;
    select * from Blog where id = #{id}
  &lt;/select&gt;
&lt;/mapper&gt;</pre></div>

		
<p>En tal caso puedes activar el logging de todo el fichero a&#xf1;adiendo un logger para el namespace como se muestra a continuaci&#xf3;n:</p>

        
<div class="source">
<pre>log4j.logger.org.mybatis.example.BlogMapper=TRACE</pre></div>

		
<p>O para un statement espec&#xed;fico:</p>

        
<div class="source">
<pre>log4j.logger.org.mybatis.example.BlogMapper.selectBlog=TRACE</pre></div>

		
<p>S&#xed;, como ya te habr&#xe1;s dado cuenta, no hay ninguna diferencia entre configurar el logging para un mapper o para un fichero XML.</p>

        
<p><span class="label important">NOTA</span> Si usas SLF4J o Log4j 2 MyBatis le llamar&#xe1; usando MYBATIS como marker.</p>

        
<p>El resto de la configuraci&#xf3;n sirve para configurar los appenders, lo cual queda fuera del &#xe1;mbito de este documento. Sin embargo, puedes encontrar m&#xe1;s informaci&#xf3;n en el site de Log4j (la url est&#xe1; m&#xe1;s arriba). O, puedes simplemente experimentar para ver los efectos que consigues con las distintas opciones de configuraci&#xf3;n.</p>
      </div></div>
    </div>
  

      </div>
    </div>
    <div class="clear">
      <hr/>
    </div>
    <div id="footer">
      <div class="xright">
              Copyright &#169;                    2010&#x2013;2016
                        <a href="http://www.mybatis.org/">MyBatis.org</a>.
            All rights reserved.      
                    
                  </div>
      <div class="clear">
        <hr/>
      </div>
    </div>
  </body>
</html>
